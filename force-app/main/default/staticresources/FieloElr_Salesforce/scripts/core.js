!function(){"use strict";var e=function(e){this.element_=e,this&&"function"==typeof this.init&&this.init()};window.FieloProgramSelectorELR=e,e.prototype.Constant_={PROGRAM:"FieloELR__Program__c"},e.prototype.CssClasses_={PAGINATOR:"fielosf-paginator"},e.prototype.onChange=function(){console.log("Changing Program.");var e={};this.getProgramId_(),[].forEach.call(this.programActions_,function(e){e.FieloButton.setParameter(this.Constant_.PROGRAM,this.programId_)},this),e[this.field_]=this.programId_;try{Visualforce.remoting.Manager.invokeAction("FieloELR.BackEndProgramSelectorController.selectProgram",e[this.field_],function(){},{escape:!1})}catch(t){console.log(t),fielo.util.spinner.FieloSpinner.hide()}[].forEach.call(this.listOfPaginators_,function(t){t.FieloPaginator.setFilters(e),t.FieloPaginator.setPage(),t.FieloPaginator.getRecords()},this),this.callback()},e.prototype.getProgramId_=function(){this.programId_=this.element_.FieloFormElement.get("value")},e.prototype.init=function(){this.element_&&(componentHandler.upgradeElement(this.element_),window.FieloProgramSelectorELR=this.onChange.bind(this),this.field_="Program__c",this.getProgramId_(),this.callback=function(){},this.listOfPaginators_=document.getElementsByClassName(this.CssClasses_.PAGINATOR),this.programActions_=document.querySelectorAll('.slds-button[data-parameters*="'+this.Constant_.PROGRAM+'"]'))},componentHandler.register({constructor:e,classAsString:"FieloProgramSelectorELR",cssClass:"fielosf-program-selector-elr",widget:!0})}(),function(){"use strict";var e=function(e){this.element_=e,this.init()};window.FieloELearning=e,e.prototype.CssClasses_={COURSES_CONTAINER:"fielosf-courses-container",CREATE_COURSE:"fielosf-create-course",TABS:"slds-tabs--default",PROGRAM_SELECTOR:"fielosf-program-selector",VIEW_SELECTOR:"fielosf-view-selector",TITLE:"slds-page-header__title",HIDE:"slds-hide",LANDING_PAGE:"fielosf-elearning-landing",COURSE_VIEW_PAGE:"fielosf-course-view",MODULE_VIEW_PAGE:"fielosf-module-view",RECENT_RECORDS:"fielosf-recent-records",RECENT_REORDER:"fielosf-recent-reorder",RELATED_MODEL:"fielosf-related-records__model"},e.prototype.Constant_={COURSES:"courses-panel",LANDING_SEGMENT_CONTROLLER:"FieloELR.CourseLandingController.getSegments",VIEW_SEGMENT_CONTROLLER:"FieloELR.CourseViewController.getSegments"},e.prototype.setDefaults_=function(){this.title_=this.element_.getElementsByClassName(this.CssClasses_.TITLE)[0],this.createcourse_=this.element_.getElementsByClassName(this.CssClasses_.CREATE_COURSE)[0],this.viewSelector_=void 0===this.element_.getElementsByClassName(this.CssClasses_.VIEW_SELECTOR)[0]?null:this.element_.getElementsByClassName(this.CssClasses_.VIEW_SELECTOR)[0].FieloFilter,null!==this.viewSelector_&&(this.viewSelector_.callback=this.updateViewTitle.bind(this)),this.memberId_=null,this.updateViewTitle()},e.prototype.updateViewTitle=function(){void 0!==this.viewSelector_&&null!==this.viewSelector_&&void 0!==this.viewSelector_.itemActive_&&null!==this.viewSelector_.itemActive_&&(this.title_.textContent=String(this.viewSelector_.itemActive_.textContent).trim()+" Courses")},e.prototype.renderSegments_=function(e){fielo.util.spinner.FieloSpinner.hide();var t=this.activeForm_.elements_.FieloELR__Segment__c;if(t){var i=[];e.forEach(function(e){i.push({id:e.Id,label:e.Name})}),t.setAttribute("data-options",JSON.stringify(i)),t.FieloFormElement.configMultiselect_()}},e.prototype.getSegments=function(){var e=void 0===document.getElementsByClassName(this.CssClasses_.LANDING_PAGE)[0]?this.Constant_.VIEW_SEGMENT_CONTROLLER:this.Constant_.LANDING_SEGMENT_CONTROLLER;fielo.util.spinner.FieloSpinner.show();try{Visualforce.remoting.Manager.invokeAction(e,this.memberId_,this.renderSegments_.bind(this),{escape:!1})}catch(t){console.warn(t)}},e.prototype.disableProgramChange_=function(){void 0!==document.getElementsByClassName(this.CssClasses_.COURSE_VIEW_PAGE)[0]&&$('[data-field-name="FieloELR__Program__c"]').addClass("disabled")},e.prototype.disableCourseChange_=function(){void 0===document.getElementsByClassName(this.CssClasses_.COURSE_VIEW_PAGE)[0]&&void 0===document.getElementsByClassName(this.CssClasses_.MODULE_VIEW_PAGE)[0]||$('[data-field-name="FieloELR__Course__c"]').addClass("disabled")},e.prototype.disableModuleChange_=function(){void 0!==document.getElementsByClassName(this.CssClasses_.MODULE_VIEW_PAGE)[0]&&$('[data-field-name="FieloELR__Module__c"]').addClass("disabled")},e.prototype.hideRelatedColumn=function(e,t){var i=$(e).find("."+this.CssClasses_.RELATED_MODEL),s=null;if([].forEach.call(i,function(e){s=$(e).find('[data-field="'+t+'"]')[0],s&&($(s).toggle(!1),$(s).parent().toggle(!1))},this),s){var o=$(s).parent().index(),n=$(s).closest("table").find("thead").find("tr")[0].cells[o];$(n).toggle(!1)}},e.prototype.reorderRenderRecords_=function(e){var t=$("."+this.CssClasses_.RECENT_RECORDS)[0].FieloRecentRecords;t.renderRecords_(e);var i=$("."+this.CssClasses_.RECENT_REORDER)[0].FieloRecentReorder;i.removeGrips(),i.addGrips()},e.prototype.decodeEntities=function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},e.prototype.fixJSON=function(){var e=$("#formModel").find('[data-field-name="FieloPLT__JSON__c"]')[0];e&&e.FieloFormElement.set("value",this.decodeEntities(e.FieloFormElement.get("value")))},e.prototype.programChangeProxy_=function(e){var t=document.getElementsByClassName("fielosf-elearning")[0].FieloELearning;t.activeForm_=$(this.element_).closest(".slds-form")[0].FieloForm,e&&e.id!==t.memberId_&&(t.activeForm_.parameters_.FieloELR__Program__c=$(t.activeForm_.element_).find('[data-field-name="FieloELR__Program__c"]')[0].FieloFormElement.get("value"),t.memberId_=e.id,t.getSegments())},window.RefreshSegments=e.prototype.programChangeProxy_,e.prototype.init=function(){if(this.element_){this.setDefaults_(),$(this.element_).on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableProgramChange_()}),$("#FieloELR__Module__cFormNew").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableCourseChange_()}),$("#FieloELR__Module__cForm").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableCourseChange_()}),$("#FieloELR__CourseDependency__cFormNew").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableCourseChange_()}),$("#FieloELR__CourseDependency__cForm").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableCourseChange_()}),$("#FieloELR__Question__cForm").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__Question__cFormNew").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__ModuleDependency__cForm").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__ModuleDependency__cFormNew").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__Question__cFormWizard-multiplechoice").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__Question__cForm-multiplechoice").on("shown.aljs.modal",function(){var e=document.getElementsByClassName("fielosf-elearning")[0];e.FieloELearning.disableModuleChange_()}),$("#FieloELR__Module__cFormReorder").on("shown.aljs.modal",function(e){var t=document.getElementsByClassName("fielosf-elearning")[0],i=$(e.target).find("."+t.FieloELearning.CssClasses_.RECENT_RECORDS)[0],s=i.FieloRecentRecords.getPaginator();s&&s.FieloPaginator&&(s.FieloPaginator.setPage(),s.FieloPaginator.getRecords(),s.FieloPaginator.callback=t.FieloELearning.reorderRenderRecords_.bind(t.FieloELearning))});var e=$("#FieloELR__CourseDependency__cRelatedList")[0];e&&(this.hideRelatedColumn(e,"Name"),e.FieloRelatedRecords.renderCallback_=this.hideRelatedColumn.bind(this,e,"Name"));var t=$("#FieloELR__ModuleDependency__cRelatedList")[0];t&&(this.hideRelatedColumn(t,"Name"),t.FieloRelatedRecords.renderCallback_=this.hideRelatedColumn.bind(this,t,"Name"));var i=$("#formModel")[0];i&&(i.FieloForm.endRetrieve=this.fixJSON.bind(this))}},fielo.helper.register({constructor:e,classAsString:"FieloELearning",cssClass:"fielosf-elearning",widget:!0})}(),function(){"use strict";var e=function(e){this.element_=e,this.init()};window.FieloRecentReorder=e,e.prototype.Constant_={UI_DISABLED:"ui-state-disabled",UI_HANDLE:"ui-sortable-handle"},e.prototype.CssClasses_={CONTAINER:"fielosf-recent-records__container",FIELD:"fielosf-output",MODEL:"fielosf-recent-records__model",SAVE:"fielosf-module-reorder__save",GRIPS:"fielosf-draggable__grip",CURSOR:"fielosf-draggable__cursor"},e.prototype.get=function(){var e=this.container_.getElementsByClassName(this.CssClasses_.MODEL),t=[];return[].forEach.call(e,function(e){var i={};i.id=e.getAttribute("data-record-id"),i[this.orderByField_]=e.querySelector('[data-field = "'+this.orderByField_+'"]').innerHTML,t.push(i)},this),t},e.prototype.save_=function(){if(!this.disableReorder){fielo.util.spinner.FieloSpinner.show();var e=this.get();try{Visualforce.remoting.Manager.invokeAction(this.element_.getAttribute("data-save-controller"),e,this.processRemoteActionResult_.bind(this),{escape:!1})}catch(t){console.warn(t)}}},e.prototype.processRemoteActionResult_=function(e){var t=fielo.util.notify.create();t.FieloNotify.addMessages([e.messagesSet]),e.messages[0].severity&&"ERROR"===e.messages[0].severity?t.FieloNotify.setTheme("error"):(t.FieloNotify.setTheme("success"),location.reload()),fielo.util.spinner.FieloSpinner.hide(),t.FieloNotify.show()},e.prototype.sortable_=function(){if("TBODY"===this.container_.nodeName){var e=this.container_.querySelectorAll("td, th");$(e).each(function(){var e=$(this);e.width(e.width())})}this.addGrips(),$(this.container_).sortable({update:this.order.bind(this),revert:!0,cancel:"."+this.Constant_.UI_DISABLED})},e.prototype.disableSort=function(){var e=$(this.element_).find("tr");[].forEach.call(e,function(e){$(e).hasClass(this.Constant_.UI_DISABLED)||$(e).addClass(this.Constant_.UI_DISABLED),$(e).hasClass(this.Constant_.UI_HANDLE)&&$(e).removeClass(this.Constant_.UI_HANDLE)},this),this.removeGrips()},e.prototype.enableSort=function(){var e=$(this.element_).find("tr");[].forEach.call(e,function(e){$(e).hasClass(this.Constant_.UI_DISABLED)&&$(e).removeClass(this.Constant_.UI_DISABLED),$(e).hasClass(this.Constant_.UI_HANDLE)||$(e).addClass(this.Constant_.UI_HANDLE)},this),this.addGrips()},e.prototype.addGrips=function(){if(!this.hasGrips){this.hasGrips=!0;var e=$(this.element_).find("tr");e=$(e).not(e[0]),[].forEach.call(e,function(e){$(e).hasClass(this.CssClasses_.GRIPS)||$(e).addClass(this.CssClasses_.GRIPS),$(e).hasClass(this.CssClasses_.CURSOR)||$(e).addClass(this.CssClasses_.CURSOR)},this)}},e.prototype.removeGrips=function(){if(this.hasGrips){this.hasGrips=!1;var e=$(this.element_).find("tr");e=$(e).not(e[0]),[].forEach.call(e,function(e){$(e).hasClass(this.CssClasses_.GRIPS)&&$(e).removeClass(this.CssClasses_.GRIPS),$(e).hasClass(this.CssClasses_.CURSOR)&&$(e).removeClass(this.CssClasses_.CURSOR)},this)}},e.prototype.order=function(){var e=this.container_.getElementsByClassName(this.CssClasses_.MODEL),t=1,i=null;[].forEach.call(e,function(e){i=e.querySelector('[data-field = "'+this.orderByField_+'"]'),i&&(i.innerHTML=t),t++},this)},e.prototype.init=function(){this.element_&&(this.container_=this.element_.getElementsByClassName(this.CssClasses_.CONTAINER)[0]||null,this.orderByField_=this.element_.getAttribute("data-order-by"),this.sortable_(),this.order(),this.saveBtn_=this.element_.querySelector("."+this.CssClasses_.SAVE),this.saveBtn_&&this.saveBtn_.addEventListener("click",this.save_.bind(this)))},fielo.helper.register({constructor:e,classAsString:"FieloRecentReorder",cssClass:"fielosf-recent-reorder",widget:!0})}(),function(){"use strict";var e=function(e){this.element_=e,this.init()};window.FieloQuestionManage=e,e.prototype.Constant_={OBJECT_NAME:"data-object-name",SAVE_CONTROLLER:"FieloELR.LevelReorderController.reorder",DATA_CONTROLLER:"data-controller-element",DATA_UPGRADED:"data-upgraded"},e.prototype.CssClasses_={CONTAINER:"fielosf-recent-records__container",FIELD:"fielosf-output",MODEL:"fielosf-recent-records__model",SAVE:"fielosf-question-manage__save",CANCEL:"fielosf-question-manage__cancel",SECTION_PANEL:"slds-panel__section",FORM_ELEMENT:"slds-form-element",REORDER:"fielosf-recent-reorder"},e.prototype.getModule_=function(){var e=this.element_.getElementsByClassName(this.CssClasses_.SECTION_PANEL)[0],t=$(e).find("."+this.CssClasses_.FORM_ELEMENT),i={};return i.id=this.parameters_.Id||this.parameters_.cloneId||this.parameters_.FieloELR__Module__c,[].forEach.call(t,function(e){i[e.FieloFormElement.get("fieldName")]=e.FieloFormElement.get("value")},this),i},e.prototype.getQuestions_=function(){var e=this.element_.getElementsByClassName(this.CssClasses_.SECTION_PANEL)[1],t=$(e).find("."+this.CssClasses_.FORM_ELEMENT),i={};[].forEach.call(t,function(e){i[e.FieloFormElement.get("fieldName")]=e.FieloFormElement.get("value")},this);var s=$(this.element_).find("."+this.CssClasses_.MODEL),o=this.elements_.FieloELR__ShuffleQuestions__c.FieloFormElement.get("value"),n=[];return[].forEach.call(s,function(e){var t={};t.id=e.getAttribute("data-record-id"),o||(t.FieloELR__Order__c=$(e).find('[data-field = "FieloELR__Order__c"]')[0].innerHTML),this.questionFields_&&this.questionFields_.forEach(function(i){t[i]=$(e).find('[data-field-name= "'+i+'"]')[0].FieloFormElement.get("value")},this),[].forEach.call(Object.keys(i),function(e){this.questionFields_?this.questionFields_.has(e)||(t[e]=i[e]):t[e]=i[e]},this),n.push(t)},this),n},e.prototype.retrieve_=function(e){if(this.parameters_=e.FieloButton.getParameters(),this.setParameters_(),this.parameters_.hasOwnProperty("Id")||this.parameters_.hasOwnProperty("FieloELR__Module__c")||this.parameters_.hasOwnProperty("cloneId")){this.isEditing=!0,this.recordId_=this.parameters_.Id;var t=this.parameters_.Id||this.parameters_.cloneId||this.parameters_.FieloELR__Module__c;this.fields_=this.moduleFields_;var i=this.element_.getAttribute(this.Constant_.OBJECT_NAME);Visualforce.remoting.Manager.invokeAction(this.element_.getAttribute("data-retrieve-controller"),i,t,this.fields_.join(),this.retrieveHandler_.bind(this),{escape:!0})}else this.isEditing=!1,this.setParameters_(),this.endRetrieve()},e.prototype.retrieveProxy_=function(e,t){e.FieloQuestionManage.retrieve_(t)},window.FieloQuestionManage_retrieve=e.prototype.retrieveProxy_,e.prototype.retrieveHandler_=function(e){fielo.util.spinner.FieloSpinner.show(),this.result=e;try{var t="|";for(var i in e)e.hasOwnProperty(i)&&i.indexOf("__r")>-1&&(t+=i.slice(0,-1)+"c|");if(this.fields_.forEach(function(i){if(t.indexOf(i)>-1){var s;switch(typeof e[i.slice(0,-1)+"r"]){case"object":s=e[i.slice(0,-1)+"r"];var o;for(var n in s)if(s.hasOwnProperty(n)&&n.indexOf("__c")>-1){o=n;break}s=o?s[o].split(";"):e[i];break;case"array":default:s=e[i.slice(0,-1)+"r"]}this.elements_[i].FieloFormElement.set("value",s)}else this.elements_[i]&&("input-date"===this.elements_[i].FieloFormElement.get("type")&&(e[i]=fielo.util.parseDateFromSF(e[i])),this.elements_[i].FieloFormElement.set("value",e[i]))},this),e.FieloELR__Questions__r&&e.FieloELR__Questions__r.length>0){var s=this.element_.getElementsByClassName(this.CssClasses_.SECTION_PANEL)[1],o=$(s).find("."+this.CssClasses_.FORM_ELEMENT);[].forEach.call(o,function(t){t.FieloFormElement.set("value",e.FieloELR__Questions__r[0][t.FieloFormElement.get("fieldName")])},this)}this.setParameters_(),this.endRetrieve()}catch(n){var l=fielo.util.notify.create();l.FieloNotify.addMessages([this.Constant_.HAS_ERROR,n]),l.FieloNotify.setTheme("error"),l.FieloNotify.show()}for(var r=this.element_.getElementsByClassName(this.CssClasses_.ELEMENTS),a=0;a<r.length;a++){var _=r[a].FieloFormElement.get("type");if("lookup"===_||_.indexOf("input")!==-1){r[a].getElementsByClassName("slds-input")[0].focus();break}}fielo.util.spinner.FieloSpinner.hide()},e.prototype.setParameters_=function(){for(var e in this.parameters_)e in this.parameters_&&e in this.elements_&&this.elements_[e].FieloFormElement.set("value",this.parameters_[e])},e.prototype.save_=function(){var e=this.getModule_(),t=this.getQuestions_(),i=[],s={};[].forEach.call(Object.keys(e),function(t){""!==e[t]&&null!==e[t]||i.push(t)}),t.forEach(function(t){"Negative Weight"===e.FieloELR__PenaltyMode__c?t.FieloELR__PenaltyPerAttempt__c=0:"Percent Decrease"===e.FieloELR__PenaltyMode__c?t.FieloELR__IncorrectWeight__c=0:"None"===e.FieloELR__PenaltyMode__c&&(t.FieloELR__PenaltyPerAttempt__c=0,t.FieloELR__IncorrectWeight__c=0),"Unlimited"===e.FieloELR__AttemptsAllowedPerQuestion__c&&(e.FieloELR__AttemptsAllowedPerQuestion__c=""),[].forEach.call(Object.keys(t),function(e){""!==t[e]&&null!==t[e]||(s[t.id]||(s[t.id]=[]),s[t.id].push(e))})}),[].forEach.call(t,function(e){if("r['id']"===e.id){var i=t.indexOf(e);i>-1&&t.splice(i,1)}},this);try{Visualforce.remoting.Manager.invokeAction(this.element_.getAttribute("data-save-controller"),e,i,t,s,this.processRemoteActionResult_.bind(this),{escape:!1})}catch(o){console.warn(o)}},e.prototype.getFields_=function(){var e=$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[0]).find("."+this.CssClasses_.FORM_ELEMENT);null!==this.moduleFields_&&void 0!==this.moduleFields_||(this.moduleFields_=[]),this.elements_=[],[].forEach.call(e,function(e){this.moduleFields_.push(e.FieloFormElement.get("fieldName")),this.elements_[e.FieloFormElement.get("fieldName")]=e},this)},e.prototype.changeForm=function(){var e=this.elements_.FieloELR__PenaltyMode__c.FieloFormElement.get("value"),t=this.elements_.FieloELR__WeightedQuestions__c.FieloFormElement.get("value"),i=this.elements_.FieloELR__ShuffleQuestions__c.FieloFormElement.get("value"),s=this.elements_.FieloELR__QuestionPool__c.FieloFormElement.get("value"),o=$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[1]).find('[data-field-name="FieloELR__IncorrectWeight__c"]'),n=$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[1]).find('[data-field-name="FieloELR__PenaltyPerAttempt__c"]'),l=$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[0]).find('[data-field-name="FieloELR__ShuffleQuestions__c"]')[0],r=$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[0]).find('[data-field-name="FieloELR__WeightedQuestions__c"]')[0];i?this.reorderObject.disableSort():this.reorderObject.enableSort(),"None"===e?(o.toggle(!1),n.toggle(!1),t?(this.addInputs("FieloELR__CorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c")):(this.removeInputs("FieloELR__CorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c"))):"Percent Decrease"===e?(o.toggle(!1),t?(n.toggle(!1),this.addInputs("FieloELR__CorrectWeight__c"),this.addInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c")):(n.toggle(!0),this.removeInputs("FieloELR__CorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c"))):"Negative Weight"===e?(n.toggle(!1),t?(o.toggle(!1),this.addInputs("FieloELR__CorrectWeight__c"),this.addInputs("FieloELR__IncorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c")):(o.toggle(!0),this.removeInputs("FieloELR__CorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c"))):(o.toggle(!1),n.toggle(!1),this.removeInputs("FieloELR__CorrectWeight__c"),this.removeInputs("FieloELR__PenaltyPerAttempt__c"),this.removeInputs("FieloELR__IncorrectWeight__c")),null===s||void 0===s||""===s?($(l).hasClass("disabled")&&($(l).removeClass("disabled"),l.FieloFormElement.set("value",!1)),$(r).hasClass("disabled")&&($(r).removeClass("disabled"),r.FieloFormElement.set("value",!1),this.changeForm())):s>0?($(l).hasClass("disabled")||($(l).addClass("disabled"),l.FieloFormElement.set("value",!0)),$(r).hasClass("disabled")||($(r).addClass("disabled"),r.FieloFormElement.set("value",!1),this.changeForm())):($(l).hasClass("disabled")&&($(l).removeClass("disabled"),l.FieloFormElement.set("value",!1)),$(r).hasClass("disabled")&&($(r).removeClass("disabled"),r.FieloFormElement.set("value",!1),this.changeForm()))},e.prototype.endRetrieve=function(){this.changeForm()},e.prototype.processRemoteActionResult_=function(e){var t=fielo.util.notify.create();t.FieloNotify.addMessages([e.messagesSet]),e.messages[0].severity&&"ERROR"===e.messages[0].severity?t.FieloNotify.setTheme("error"):(t.FieloNotify.setTheme("success"),location.reload()),fielo.util.spinner.FieloSpinner.hide(),t.FieloNotify.show()},e.prototype.addInputs=function(e){var t,i,s=$(this.element_).find("."+this.CssClasses_.MODEL);this.showColumn(e),this.addField(e),[].forEach.call(s,function(s){t=$(s).find('[data-field="'+e+'"]')[0],t&&("FieloELR__CorrectWeight__c"===e?i=this.correctWeightModel.cloneNode(!0):"FieloELR__IncorrectWeight__c"===e?i=this.incorrectWeightModel.cloneNode(!0):"FieloELR__PenaltyPerAttempt__c"===e&&(i=this.penaltyPerAttemptModel.cloneNode(!0)),this.initField(i),i.FieloFormElement.set("value",t.innerHTML),$(t).closest("td")[0].appendChild(i),$(t).closest("td").hasClass("ui-state-disabled")||$(t).closest("td").addClass("ui-state-disabled"),i&&($(t).closest("td")[0].removeChild(t),$(i).toggle(!0),$(i).closest("td").toggle(!0)))},this)},e.prototype.removeInputs=function(e){var t=$(this.element_).find("."+this.CssClasses_.MODEL),i=null,s=null;this.removeField(e),[].forEach.call(t,function(t){i=$(t).find('[data-field-name="'+e+'"]')[0],i&&("FieloELR__CorrectWeight__c"===e?s=this.correctWeightOutputModel.cloneNode(!0):"FieloELR__IncorrectWeight__c"===e?s=this.incorrectWeightOutputModel.cloneNode(!0):"FieloELR__PenaltyPerAttempt__c"===e&&(s=this.penaltyPerAttemptOutputModel.cloneNode(!0)),s.innerHTML=i.FieloFormElement.get("value"),$(i).closest("td")[0].appendChild(s),s&&($(i).closest("td")[0].removeChild(i),$(s).toggle(!0)))},this),this.hideColumn(e)},e.prototype.hideColumn=function(e){var t=$(this.element_).find("."+this.CssClasses_.MODEL),i=null;if([].forEach.call(t,function(t){i=$(t).find('[data-field-name="'+e+'"]')[0],i||(i=$(t).find('[data-field="'+e+'"]')[0]),i&&($(i).toggle(!1),$(i).closest("td").toggle(!1))},this),i){var s=$(i).closest("td").index(),o=$("#"+this.element_.id).find("thead").find("tr")[0].cells[s];$(o).toggle(!1)}},e.prototype.showColumn=function(e){var t=$(this.element_).find("."+this.CssClasses_.MODEL),i=null;if([].forEach.call(t,function(t){i=$(t).find('[data-field-name="'+e+'"]')[0],i||(i=$(t).find('[data-field="'+e+'"]')[0]),i&&($(i).toggle(!0),$(i).closest("td").toggle(!0))},this),i){var s=$(i).closest("td").index(),o=$("#"+this.element_.id).find("thead").find("tr")[0].cells[s];$(o).toggle(!0)}},e.prototype.initField=function(e){e.removeAttribute(this.Constant_.DATA_UPGRADED),this.fieldIndex||(this.fieldIndex=1),e.id=String(e.id+"-"+this.fieldIndex);var t=e.getAttribute(this.Constant_.DATA_CONTROLLER)||null;t&&0!==this.fieldIndex&&(e.setAttribute(this.Constant_.DATA_CONTROLLER,String(t+"-"+this.fieldIndex)),this.fieldIndex++),componentHandler.upgradeElement(e)},e.prototype.init=function(){this.element_&&(this.container_=this.element_.getElementsByClassName(this.CssClasses_.CONTAINER)[0]||null,this.element_.getElementsByClassName(this.CssClasses_.SAVE)[0].addEventListener("click",this.save_.bind(this)),this.reorderObject=this.element_.FieloRecentReorder,this.reorderObject&&(this.reorderObject.disableReorder=!0),$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[1]).find("h3")[0].innerHTML="Global Question Setup",$($(this.element_).find("."+this.CssClasses_.SECTION_PANEL)[0]).find("h3")[0].innerHTML="Module Setup",$("#"+this.element_.id+"-section-Id").toggle(!1),$("#"+this.element_.id+"-questionsection-Id").toggle(!1),$("#"+this.element_.id).find('[data-field-name="FieloELR__IncorrectWeight__c"]').toggle(!1),$("#"+this.element_.id).find('[data-field-name="FieloELR__PenaltyPerAttempt__c"]').toggle(!1),$("#"+this.element_.id).find('[data-field-name="FieloELR__CorrectWeight__c"]').toggle(!1),this.swapAttemptsAllowedPerQuestion(),this.getFields_(),this.initModels(),this.hideColumn("FieloELR__Order__c"),[].forEach.call(Object.keys(this.elements_),function(e){"FieloELR__WeightedQuestions__c"!==e&&"FieloELR__ShuffleQuestions__c"!==e&&"FieloELR__QuestionPool__c"!==e&&"FieloELR__PenaltyMode__c"!==e||(this.elements_[e].addEventListener("change",this.changeForm.bind(this)),componentHandler.upgradeElement(this.elements_[e]))},this))},e.prototype.addField=function(e){this.questionFields_||(this.questionFields_=new Set),this.questionFields_.add(e)},e.prototype.removeField=function(e){this.questionFields_&&this.questionFields_.has(e)&&this.questionFields_["delete"](e)},e.prototype.swapAttemptsAllowedPerQuestion=function(){var e=$(this.element_).find('[data-field-name="FieloELR__AttemptsAllowedPerQuestion__c"]'),t=null,i=null;[].forEach.call(e,function(e){$(e).hasClass("slds-hide")?i=e:t=e}),$(i).insertBefore(t),$(i).hasClass("slds-hide")&&$(i).removeClass("slds-hide"),$(i).hasClass("slds-is-collapsed")&&$(i).removeClass("slds-is-collapsed"),$(t).remove()},e.prototype.initModels=function(){this.incorrectWeightModel=$("#"+this.element_.id).find('[data-field-name="FieloELR__IncorrectWeight__c"]')[0].cloneNode(!0),this.penaltyPerAttemptModel=$("#"+this.element_.id).find('[data-field-name="FieloELR__PenaltyPerAttempt__c"]')[0].cloneNode(!0),this.correctWeightModel=$("#"+this.element_.id).find('[data-field-name="FieloELR__CorrectWeight__c"]')[0].cloneNode(!0),this.incorrectWeightOutputModel=$("#"+this.element_.id).find('[data-field="FieloELR__IncorrectWeight__c"]')[0].cloneNode(!0),this.penaltyPerAttemptOutputModel=$("#"+this.element_.id).find('[data-field="FieloELR__PenaltyPerAttempt__c"]')[0].cloneNode(!0),this.correctWeightOutputModel=$("#"+this.element_.id).find('[data-field="FieloELR__CorrectWeight__c"]')[0].cloneNode(!0),this.incorrectWeightModel.removeChild($(this.incorrectWeightModel).find("label")[0]),this.penaltyPerAttemptModel.removeChild($(this.penaltyPerAttemptModel).find("label")[0]),this.correctWeightModel.removeChild($(this.correctWeightModel).find("label")[0])},fielo.helper.register({constructor:e,classAsString:"FieloQuestionManage",cssClass:"fielosf-question-manage",widget:!0})}(),function(){"use strict";var e=function(e){this.element_=e,this.init()};window.FieloQuestionWizard=e,e.prototype.Constant_={OBJECT_NAME:"data-object-name",SAVE_CONTROLLER:"FieloELR.LevelReorderController.reorder",DATA_CONTROLLER:"data-controller-element",DATA_UPGRADED:"data-upgraded",FORM_ID_SUFIX:"multiplechoice"},e.prototype.CssClasses_={RECENT_CONTAINER:"fielosf-recent-records__container",FIELD:"fielosf-output",MODEL:"fielosf-recent-records__model",SAVE:"fielosf-question-wizard__save",SAVE_NEW:"fielosf-question-wizard__saveNew",NEXT:"fielosf-question-wizard__next",NEXT_MULTIPLE_CHOICE:"fielosf-question-wizard__next-multiplechoice",CANCEL:"fielosf-question-wizard__cancel",SECTION_PANEL:"slds-panel__section",FORM_ELEMENT:"slds-form-element",FORM_ELEMENT_LABEL:"slds-form-element__label",REORDER:"fielosf-recent-reorder",ANSWER_OPTIONS:"fielosf-answer-options",ANSWER_OPTIONS_ITEM:"fielosf-answer-options__item",DATA_FIELD_NAME:"data-field-name",DATA_FIELD_TABLE:"data-field",OUTPUT_ELEMENT:"fielosf-output"},e.prototype.getQuestion_=function(){var e=this.form_.getElementsByClassName(this.CssClasses_.SECTION_PANEL)[0],t=$(e).find("."+this.CssClasses_.FORM_ELEMENT),i={};return(this.parameters_.hasOwnProperty("Id")||this.parameters_.hasOwnProperty("cloneId"))&&(i.id=this.parameters_.Id||this.parameters_.cloneId),[].forEach.call(t,function(e){i[e.FieloFormElement.get("fieldName")]=e.FieloFormElement.get("value")},this),i},e.prototype.getDeletedAnswerIds_=function(){var e=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS)[0],t=null;return e&&(t=e.FieloAnswerOptions.deletedItems),t},e.prototype.getAnswerOptions_=function(){var e=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS)[0],t=null;return e&&(t=e.FieloAnswerOptions.get()),t},e.prototype.throwMessage=function(e,t){var i=fielo.util.notify.create();i.FieloNotify.addMessages(t),i.FieloNotify.setTheme(e),i.FieloNotify.show()},e.prototype.retrieve_=function(e){if(this.parameters_=e.FieloButton.getParameters(),this.setParameters_(),this.parameters_.hasOwnProperty("Id")||this.parameters_.hasOwnProperty("cloneId")){this.isEditing=!0,this.recordId_=this.parameters_.Id;var t=this.parameters_.Id||this.parameters_.cloneId;this.fields_=Array.from(this.questionFields_),Visualforce.remoting.Manager.invokeAction(this.form_.getAttribute("data-retrieve-controller"),this.form_.getAttribute("data-object-name"),t,this.fields_.join(),this.retrieveHandler_.bind(this),{escape:!1})}else this.isEditing=!1,this.setParameters_(),this.endRetrieve()},e.prototype.retrieveProxy_=function(e,t){$(e).closest(".fielosf-question-wizard")[0].FieloQuestionWizard.retrieve_(t)},window.FieloQuestionWizard_retrieve=e.prototype.retrieveProxy_,e.prototype.retrieveHandler_=function(e){fielo.util.spinner.FieloSpinner.show(),[].forEach.call(Object.keys(e),function(t){t.indexOf("__c")>-1&&"string"==typeof e[t]&&(e[t]=this.decode(e[t]))},this),this.result=e,console.log(this.result),$("#"+this.formId_).find('[data-field-name="FieloELR__Type__c"]')[0].FieloFormElement.set("value",e.FieloELR__Type__c),this.next_();try{var t="|";for(var i in e)e.hasOwnProperty(i)&&i.indexOf("__r")>-1&&(t+=i.slice(0,-1)+"c|");this.fields_.forEach(function(i){if(t.indexOf(i)>-1){var s;switch(typeof e[i.slice(0,-1)+"r"]){case"object":s=e[i.slice(0,-1)+"r"];var o;for(var n in s)if(s.hasOwnProperty(n)&&n.indexOf("__c")>-1){o=n;break}s=o?s[o].split(";"):e[i];break;case"array":default:s=e[i.slice(0,-1)+"r"]}this.elements_[i].FieloFormElement.set("value",s)}else this.elements_[i]&&("input-date"===this.elements_[i].FieloFormElement.get("type")&&(e[i]=fielo.util.parseDateFromSF(e[i])),this.elements_[i].FieloFormElement.set("value",e[i]))},this),e.FieloELR__Module__c&&(this.parameters_.FieloELR__Module__c=e.FieloELR__Module__c),e.FieloELR__AnswerOptions__r&&e.FieloELR__AnswerOptions__r.length>0&&this.setAnswers_(e.FieloELR__AnswerOptions__r),this.setParameters_(),this.endRetrieve()}catch(s){var o=fielo.util.notify.create();o.FieloNotify.addMessages([s]),o.FieloNotify.setTheme("error"),o.FieloNotify.show()}for(var n=this.element_.getElementsByClassName(this.CssClasses_.ELEMENTS),l=0;l<n.length;l++){var r=n[l].FieloFormElement.get("type");if("lookup"===r||r.indexOf("input")!==-1){n[l].getElementsByClassName("slds-input")[0].focus();break}}fielo.util.spinner.FieloSpinner.hide()},e.prototype.decode=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})},e.prototype.setAnswers_=function(e){for(var t=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS_ITEM).length,i=e.length-t;i>0;)this.newAnswer(),i--;i=0;var s=null,o=null;[].forEach.call(e,function(e){s=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS_ITEM)[i],s&&([].forEach.call(Object.keys(e),function(t){o=$(s).find('[data-field-name="'+t+'"]')[0],o&&o.FieloFormElement.set("value",e[t]),o||(o=$(s).find('[data-field="'+t+'"]')[0],o&&(o.innerHTML=e[t]))},this),s.setAttribute("data-record-id",e.Id),i++)},this)},e.prototype.unencodeHTML=function(e){var t=e,i=new DOMParser,s=i.parseFromString("<!doctype html><body>"+t,"text/html"),o=s.body.textContent;
return o},e.prototype.setParameters_=function(){for(var e in this.parameters_)e in this.parameters_&&e in this.elements_&&this.elements_[e].FieloFormElement.set("value",this.parameters_[e])},e.prototype.saveOnly_=function(){this.isSaveAndNew=!1,this.save_(),this.hasError_||$(this.form_).modal("dismiss")},e.prototype.saveAndNew_=function(){this.isSaveAndNew=!0,this.save_(),this.hasError_||$(this.form_).modal("dismiss")},e.prototype.save_=function(){var e=this.getQuestion_(),t=[],i=this.getAnswerOptions_(),s=this.getDeletedAnswerIds_();s=s?s:[];var o={},n=new Set;""!==e.Name&&null!==e.Name&&void 0!==e.Name||(e.Name=e.FieloELR__QuestionText__c.substring(0,e.FieloELR__QuestionText__c.length>20?20:e.FieloELR__QuestionText__c.length-1)),""!==e.FieloELR__QuestionText__c&&null!==e.FieloELR__QuestionText__c&&void 0!==e.FieloELR__QuestionText__c||n.add(BackEndJSSettings.LABELS.QuestionTextRequired),i.forEach(function(t){"Short Answer"===e.FieloELR__Type__c&&(t.FieloELR__IsCorrect__c=!0),"Matching Options"===e.FieloELR__Type__c&&(""===t.FieloELR__AnswerOptionText__c||null===t.FieloELR__AnswerOptionText__c||void 0===t.FieloELR__AnswerOptionText__c?t.FieloELR__IsCorrect__c=!1:t.FieloELR__IsCorrect__c=!0),"Matching Options"===e.FieloELR__Type__c?""!==t.FieloELR__MatchingText__c&&void 0!==t.FieloELR__MatchingText__c&&null!==t.FieloELR__MatchingText__c||(t.error=BackEndJSSettings.LABELS.MatchingTextRequired):""!==t.FieloELR__AnswerOptionText__c&&null!==t.FieloELR__AnswerOptionText__c&&void 0!==t.FieloELR__AnswerOptionText__c||(t.error=BackEndJSSettings.LABELS.AnswerOptionTextRequired),[].forEach.call(Object.keys(t),function(e){""!==t[e]&&null!==t[e]||t.id&&(o[t.Id]||(o[t.Id]=[]),o[t.id].push(e)),s&&s.indexOf(t.Id)!==-1&&delete i[i.indexOf(t)]}),t.error&&n.add(t.error)}),[].forEach.call(Object.keys(e),function(i){""!==e[i]&&null!==e[i]||t.push(i)});try{n.size>0?(this.hasError_=!0,this.throwMessage("error",Array.from(n))):(this.hasError_=!1,console.log(e),Visualforce.remoting.Manager.invokeAction(this.form_.getAttribute("data-save-controller"),e,t,i,o,s,this.processRemoteActionResult_.bind(this),{escape:!0}))}catch(l){console.warn(l)}},e.prototype.next_=function(){if(this.questionType_=$("#"+this.formId_).find('[data-field-name="FieloELR__Type__c"]')[0],this.formIdSufix_="",this.questionType_){switch(this.questionType_.FieloFormElement.get("value")){case"Multiple Choice":this.formIdSufix_="multiplechoice",this.initMultipleChoiceForm();break;case"Single Choice":this.formIdSufix_="multiplechoice",this.initSingleChoiceForm();break;case"Short Answer":this.formIdSufix_="multiplechoice",this.initShortAnswerForm();break;case"Statement":this.formIdSufix_="multiplechoice",this.initStatementForm();break;case"Matching Options":this.formIdSufix_="multiplechoice",this.initMatchingForm();break;default:this.formIdSufix_="error"}this.questionType_.FieloFormElement.clear(),this.questionType_.FieloFormElement.set("value","None")}"error"===this.formIdSufix_||""===this.formIdSufix_?this.throwMessage("error",[BackEndJSSettings.LABELS.ChooseQuestionType]):$(this.form_).is(":visible")||$(this.element_).find("."+this.CssClasses_.NEXT+"-"+this.formIdSufix_)[0].click()},e.prototype.initMultipleChoiceForm=function(){this.form_=$("#"+this.formId_+"-"+this.formIdSufix_)[0];var e=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS)[0];e&&e.FieloAnswerOptions&&e.FieloAnswerOptions.clear();var t=$(this.form_).find("."+this.CssClasses_.FORM_ELEMENT);[].forEach.call(t,function(e){e.FieloFormElement&&e.FieloFormElement.clear()},this),this.getFields_(),this.radioEnabled_=!1,this.showColumn("FieloELR__IsCorrect__c"),$($($(this.form_).find('[data-field-name="FieloELR__AnswerOptionText__c"]')[0]).find("input")[0]).prop("disabled",!1);var i=$(this.form_).find('[data-field-name="FieloELR__Type__c"]')[0];i&&($(i).toggle(!1),i.FieloFormElement&&(i.FieloFormElement.set("value",this.questionType_.FieloFormElement.get("value")),this.formLabel.innerHTML=this.formLabelText,this.formLabel.innerHTML=this.formLabel.innerHTML+": "+i.FieloFormElement.get("value"))),$($(this.form_).find(".slds-button--new-answer")[0]).toggle(!0),this.toggleRemoveButton(!0),this.hideColumn("FieloELR__MatchingText__c"),this.hideColumn("FieloELR__Order__c"),this.showFormField_("FieloELR__ShuffleAnswerOptions__c")},e.prototype.initSingleChoiceForm=function(){this.initMultipleChoiceForm(),this.enableRadio()},e.prototype.initShortAnswerForm=function(){this.initMultipleChoiceForm(),this.hideColumn("FieloELR__IsCorrect__c"),this.hideFormField_("FieloELR__ShuffleAnswerOptions__c"),this.disableSort()},e.prototype.disableSort=function(){this.reorderObject&&this.reorderObject.disableSort()},e.prototype.initStatementForm=function(){this.initMultipleChoiceForm(),this.enableRadio(),this.newAnswer(),this.toggleRemoveButton(!1),$($(this.form_).find(".slds-button--new-answer")[0]).toggle(!1);var e=$(this.form_).find('[data-field-name="FieloELR__AnswerOptionText__c"]');e&&(e[0].FieloFormElement.set("value",BackEndJSSettings.LABELS.True),e[1].FieloFormElement.set("value",BackEndJSSettings.LABELS.False)),this.hideFormField_("FieloELR__ShuffleAnswerOptions__c"),this.disableSort()},e.prototype.initMatchingForm=function(){this.initMultipleChoiceForm(),this.hideColumn("FieloELR__IsCorrect__c"),this.showColumn("FieloELR__MatchingText__c")},e.prototype.radioChoice=function(e){var t=$(this.form_).find('[data-field-name="FieloELR__Type__c"]')[0];if("Single Choice"===t.FieloFormElement.get("value")||"Statement"===t.FieloFormElement.get("value")){var i=$(this.form_).find("table").find('[data-field-name="FieloELR__IsCorrect__c"]').not(e.currentTarget);[].forEach.call(i,function(t){t.FieloFormElement.set("value",!e.currentTarget.FieloFormElement.get("value")&&t.FieloFormElement.get("value"))},this)}},e.prototype.enableRadio=function(){this.radioEnabled_||($($(this.form_).find("table").find('[data-field-name="FieloELR__IsCorrect__c"]')[0]).on("change",this.radioChoice.bind(this)),$(this.form_).find("table").find('[data-field-name="FieloELR__IsCorrect__c"]')[0].FieloFormElement.set("value",!0)),this.radioEnabled_=!0},e.prototype.getFields_=function(){var e=null===this.form_||void 0===this.form_?$("#"+this.formId_)[0]:this.form_,t=$($(e).find("."+this.CssClasses_.SECTION_PANEL)[0]).find("."+this.CssClasses_.FORM_ELEMENT);this.elements_=[],[].forEach.call(t,function(e){this.addField(e.FieloFormElement.get("fieldName")),this.elements_[e.FieloFormElement.get("fieldName")]=e},this),this.elements_.FieloELR__ShuffleAnswerOptions__c&&this.elements_.FieloELR__ShuffleAnswerOptions__c.addEventListener("change",this.changeForm.bind(this))},e.prototype.changeForm=function(){var e=$(this.form_).find('[data-field-name="FieloELR__Type__c"]')[0].FieloFormElement.get("value");switch(e){case"Statement":case"Short Answer":this.reorderObject.disableSort();break;default:var t=$(this.form_).find('[data-field-name="FieloELR__ShuffleAnswerOptions__c"]')[0].FieloFormElement.get("value");t?this.reorderObject.disableSort():this.reorderObject.enableSort()}},e.prototype.toggleRemoveButton=function(e){var t=$(this.form_).find(".slds-button--delete");[].forEach.call(t,function(t){$(t).toggle(e)})},e.prototype.removeColumn=function(e){var t=$(this.form_).find('[title="'+e+'"]')[0];if(t){var i=$(t).closest("th").index();$(t).closest("th").remove();var s=$(this.form_).find("."+this.CssClasses_.ANSWER_OPTIONS_ITEM);[].forEach.call(s,function(e){$(e.cells[i]).remove()})}},e.prototype.hideColumn=function(e){var t=$(this.form_).find("."+this.CssClasses_.MODEL),i=null;if([].forEach.call(t,function(t){i=$(t).find('[data-field-name="'+e+'"]')[0],i||(i=$(t).find('[data-field="'+e+'"]')[0]),i&&($(i).toggle(!1),$(i).closest("td").toggle(!1))},this),i){var s=$(i).closest("td").index(),o=$(i).closest("table").find("thead").find("tr")[0].cells[s];$(o).toggle(!1)}},e.prototype.showColumn=function(e){var t=$(this.form_).find("."+this.CssClasses_.MODEL),i=null;if([].forEach.call(t,function(t){i=$(t).find('[data-field-name="'+e+'"]')[0],i||(i=$(t).find('[data-field="'+e+'"]')[0]),i&&($(i).toggle(!0),$(i).closest("td").toggle(!0))},this),i){var s=$(i).closest("td").index(),o=$(i).closest("table").find("thead").find("tr")[0].cells[s];$(o).toggle(!0)}},e.prototype.getModule_=function(){var e=this.parameters_.FieloELR__Module__c;if(e){var t="FieloELR__PenaltyMode__c";t+=",FieloELR__WeightedQuestions__c",t+=",FieloELR__ShuffleQuestions__c",Visualforce.remoting.Manager.invokeAction(this.form_.getAttribute("data-retrieve-controller"),"FieloELR__Module__c",e,t,this.moduleRetrieveHandler_.bind(this),{escape:!0})}},e.prototype.moduleRetrieveHandler_=function(e){var t=e.FieloELR__PenaltyMode__c,i=e.FieloELR__WeightedQuestions__c,s=e.FieloELR__ShuffleQuestions__c;"None"===t?this.hideFormField_("FieloELR__PenaltyPerAttempt__c","FieloELR__IncorrectWeight__c"):"Percent Decrease"===t?this.hideFormField_("FieloELR__IncorrectWeight__c"):"Negative Weight"===t&&this.hideFormField_("FieloELR__PenaltyPerAttempt__c"),i||this.hideFormField_("FieloELR__CorrectWeight__c"),s&&this.hideFormField_("FieloELR__Order__c"),this.changeForm()},e.prototype.hideFormField_=function(){[].forEach.call(arguments,function(e){var t=$(this.form_).find('[data-field-name="'+e+'"]')[0];t&&$(t).toggle(!1)},this)},e.prototype.showFormField_=function(){[].forEach.call(arguments,function(e){var t=$(this.form_).find('[data-field-name="'+e+'"]')[0];t&&$(t).toggle(!0)},this)},e.prototype.endRetrieve=function(){this.getModule_()},e.prototype.processRemoteActionResult_=function(e){var t=fielo.util.notify.create();t.FieloNotify.addMessages([e.messagesSet]),e.messages[0].severity&&"ERROR"===e.messages[0].severity?t.FieloNotify.setTheme("error"):(t.FieloNotify.setTheme("success"),window.location.href=this.getNewURL(),location.reload()),fielo.util.spinner.FieloSpinner.hide(),t.FieloNotify.show()},e.prototype.getNewURL=function(){var e=window.location.href;return this.isSaveAndNew&&(e+="#"===e.substr(-1)?this.formId_:"#"+this.formId_),e},e.prototype.hideButtons_=function(){$($(this.element_).find("."+this.CssClasses_.NEXT_MULTIPLE_CHOICE)[0]).toggle(!1)},e.prototype.newAnswer=function(){this.form_&&$(this.form_).find(".slds-button--new-answer")[0].click()},e.prototype.deleteAnswer=function(e){this.form_&&$(this.form_).find(".slds-button--delete")[e]&&$(this.form_).find(".slds-button--delete")[e].click()},e.prototype.addField=function(e){this.questionFields_||(this.questionFields_=new Set),this.questionFields_.add(e)},e.prototype.getUrlParameter=function(e){var t,i,s=decodeURIComponent(window.location.search.substring(1)),o=s.split("&");for(i=0;i<o.length;i++)if(t=o[i].split("="),t[0]===e)return void 0===t[1]||t[1]},e.prototype.getModals=function(){this.element_.appendChild(document.getElementById(this.element_.getAttribute("form-id"))),this.element_.appendChild(document.getElementById(this.element_.getAttribute("form-id")+"-multiplechoice"))},e.prototype.init=function(){if(this.element_){this.getModals(),this.element_.getElementsByClassName(this.CssClasses_.NEXT)[0].addEventListener("click",this.next_.bind(this)),this.reorderObject=$("."+this.CssClasses_.ANSWER_OPTIONS)[0].FieloRecentReorder,this.formId_=this.element_.getAttribute("form-id"),this.formLabel=$("#"+this.formId_+"-"+this.Constant_.FORM_ID_SUFIX+"-headerModal")[0],this.formLabelText=this.formLabel.innerHTML,this.reorderObject&&(this.reorderObject.disableReorder=!0),this.hideButtons_(),this.multipleChoiceform_=$("#"+this.formId_+"-multiplechoice")[0],$(this.multipleChoiceform_).find("."+this.CssClasses_.SAVE)[0].addEventListener("click",this.saveOnly_.bind(this)),$(this.multipleChoiceform_).find("."+this.CssClasses_.SAVE_NEW)[0].addEventListener("click",this.saveAndNew_.bind(this)),this.form_=this.multipleChoiceform_,this.getFields_(),this.hideFormField_("FieloELR__IncorrectWeight__c","FieloELR__CorrectWeight__c","FieloELR__PenaltyPerAttempt__c");var e=window.location.hash;if(e){console.log(e);var t=$('[data-action="'+e.replace("#","")+'"]')[0];console.log(t),t&&(window.location.href=window.location.href.replace(e,"#"),t.click())}}},fielo.helper.register({constructor:e,classAsString:"FieloQuestionWizard",cssClass:"fielosf-question-wizard",widget:!0})}(),function(){"use strict";var e=function(e){this.element_=e,this.init()};window.FieloAnswerOptions=e,e.prototype.Constant_={DATA_UPGRADED:"data-upgraded",DATA_CONTROLLER:"data-controller-element",DATA_FIELD_NAME:"data-field-name",DATA_FIELD_TABLE:"data-field",OBJECT_TYPE:"FieloELR__AnswerOption__c"},e.prototype.CssClasses_={ITEM:"fielosf-answer-options__item",CONTAINER:"fielosf-answer-options__container",DELETE:"slds-button--delete",NEW:"slds-button--new-answer",FORM_ELEMENT:"slds-form-element",OUTPUT_ELEMENT:"fielosf-output",ELEMENT_LABEL:"slds-form-element__label",PILL_REMOVE:"slds-pill__remove"},e.prototype.initItem_=function(e){e.deleteBtn_=e.getElementsByClassName(this.CssClasses_.DELETE)[0],e.deleteBtn_.addEventListener("click",this.deleteItem_.bind(this,e)),this.recentReorder_=$(e).closest(".fielosf-recent-reorder")[0],this.recentReorder_&&this.recentReorder_.FieloRecentReorder.order();var t=$(e).find(".slds-form-element"),i=null;t&&[].forEach.call(t,function(e){e.closest("td")&&($(e).closest("td").hasClass("ui-state-disabled")||$(e).closest("td").addClass("ui-state-disabled")),i=$(e).find("."+this.CssClasses_.ELEMENT_LABEL)[0],i&&$(i).toggle(!1)},this)},e.prototype.deleteItem_=function(e){var t=e.getAttribute("data-record-id");t&&(this.deletedItems||(this.deletedItems=[]),this.deletedItems.push(t)),this.answerOptionItems_.length>1&&(e.remove(),this.recentReorder_&&this.recentReorder_.FieloRecentReorder.order())},e.prototype.clearItem_=function(e){[].forEach.call(e.getElementsByClassName(this.CssClasses_.FORM_ELEMENT),function(e){e.FieloFormElement&&e.FieloFormElement.clear()},this),e.setAttribute("data-record-id","")},e.prototype.newAnswerOptionItem_=function(){this.model_=$(this.answerOptionItems_[0]).clone(!0)[0];var e=$(this.model_).clone(!0)[0];$(this.container_).append(e),[].forEach.call(e.querySelectorAll("["+this.Constant_.DATA_UPGRADED+"]"),function(e,t){e.removeAttribute(this.Constant_.DATA_UPGRADED),e.id=String(e.id+"-"+this.answerOptionItems_.length);var i=e.getAttribute(this.Constant_.DATA_CONTROLLER)||null;i&&0!==t&&e.setAttribute(this.Constant_.DATA_CONTROLLER,String(i+"-"+this.answerOptionItems_.length)),componentHandler.upgradeElement(e)},this),this.initItem_(e),this.clearItem_(e)},e.prototype.get=function(){var e=[],t=null,i=null;return[].forEach.call(this.answerOptionItems_,function(s){var o={};t=s.getElementsByClassName(this.CssClasses_.FORM_ELEMENT),[].forEach.call(t,function(e){var t=e.FieloFormElement.get("value");i=e.getAttribute(this.Constant_.DATA_FIELD_NAME),o[i]=t},this),t=s.getElementsByClassName(this.CssClasses_.OUTPUT_ELEMENT),[].forEach.call(t,function(e){var t=e.innerHTML;i=e.getAttribute(this.Constant_.DATA_FIELD_TABLE),o[i]=t},this),""!==s.getAttribute("data-record-id")&&(o.Id=s.getAttribute("data-record-id")),e.push(o)},this),e},e.prototype.set=function(){return console.log("recibe lista de objetos")},e.prototype.clear=function(){this.newAnswerOptionItem_();for(var e=this.element_.getElementsByClassName(this.CssClasses_.DELETE);e.length>1;)e[0].click();this.recentReorder_&&this.recentReorder_.FieloRecentReorder.order(),this.deletedItems=null},e.prototype.init=function(){this.element_&&(this.container_=this.element_.getElementsByClassName(this.CssClasses_.CONTAINER)[0],this.answerOptionItems_=this.element_.getElementsByClassName(this.CssClasses_.ITEM),this.model_=this.answerOptionItems_[0].cloneNode(!0),this.newBtn_=this.element_.getElementsByClassName(this.CssClasses_.NEW)[0],this.newBtn_&&this.newBtn_.addEventListener("click",this.newAnswerOptionItem_.bind(this)),[].forEach.call(this.answerOptionItems_,this.initItem_.bind(this)))},fielo.util.register({constructor:e,classAsString:"FieloAnswerOptions",cssClass:"fielosf-answer-options",widget:!0})}();
//# sourceMappingURL=core.js.map
